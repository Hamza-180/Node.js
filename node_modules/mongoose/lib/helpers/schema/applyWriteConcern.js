'use strict';

const get = require('../get');

module.exports = function applyWriteConcern(schema, options) {
  const writeConcern = get(schema, 'options.writeConcern', {});

  if (options.writeConcern == null && Object.keys(writeConcern).length > 0) {
    options.writeConcern = { ...writeConcern };

    ['w', 'j', 'wtimeout'].forEach(key => {
      if (!(key in options.writeConcern) && writeConcern[key] != null) {
        options.writeConcern[key] = writeConcern[key];
      }
    });
  } else if (options.writeConcern == null) {
    ['w', 'j', 'wtimeout'].forEach(key => {
      if (!(key in options) && writeConcern[key] != null) {
        options[key] = writeConcern[key];
      }
    });
  }
};
